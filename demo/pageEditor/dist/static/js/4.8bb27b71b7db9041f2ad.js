webpackJsonp([4],{O64g:function(t,e){},WboS:function(t,e){},rgt0:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),l=a.n(i),s=a("gyMJ"),r=a("NYxO"),n=a("fAxu"),o=a("x8XE"),u=a.n(o),d={components:{},watch:{},data:function(){return{loading:!1,dialogVisible:!1,ruleID:[{required:!0,message:"请输入ID"},{validator:n.a.checkInviterId,trigger:"blur"}],ruleType:u.a.ruleType,userType:u.a.userType,dynamicValidateForm:{list:[{name:"",rule_type:"",title:"",uid:"",user_type:""}]}}},computed:l()({},Object(r.b)(["getUserInfo"])),created:function(){},mounted:function(){},methods:{reInit:function(){this.dialogVisible=!0,this.dynamicValidateForm={list:[{name:"",rule_type:"",title:"",uid:"",user_type:""}]},this.$refs.dynamicValidateForm&&this.$refs.dynamicValidateForm.resetFields()},submitForm:function(){var t=this;this.$refs.dynamicValidateForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.doAddWhite()})},doAddWhite:function(){for(var t=this,e=[],a="",i=0;i<this.dynamicValidateForm.list.length;i++){var l=this.dynamicValidateForm.list[i];if(e.indexOf(l.uid)>=0){a=l.uid;break}e.push(l.uid)}a?this.$message.warning("ID "+a+"重复申请！"):(this.loading=!0,this.$axios.post(s.a.whiteCreateApi,{info:{proposer:this.getUserInfo.name},list:this.dynamicValidateForm.list}).then(function(e){t.loading=!1,t.$message.success("添加白名单成功！"),t.dialogVisible=!1,t.$emit("add-white-callback")}).catch(function(e){t.$message.closeAll(),t.loading=!1,e=e.replace(/,/g,"<br/>"),t.$message.warning({dangerouslyUseHTMLString:!0,message:"<pre>"+e+"</pre>"})}))},resetForm:function(t){this.$refs.dynamicValidateForm.resetFields()},removeRow:function(t){var e=this.dynamicValidateForm.list.indexOf(t);-1!==e&&this.dynamicValidateForm.list.splice(e,1)},addRow:function(){this.dynamicValidateForm.list.push({name:"",rule_type:"",title:"",uid:"",user_type:""})}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"申请开通白名单",visible:t.dialogVisible,width:"1100px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"dynamicValidateForm",staticClass:"demo-dynamic",attrs:{model:t.dynamicValidateForm,"label-width":"80px",inline:!0}},t._l(t.dynamicValidateForm.list,function(e,i){return a("div",{key:i},[a("el-form-item",{attrs:{"label-width":"60px",label:"姓名",prop:"list."+i+".name",rules:{required:!0,message:"姓名不能为空",trigger:"blur"}}},[a("el-input",{staticClass:"width100",attrs:{maxLength:"6"},model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"item.name"}})],1),t._v(" "),a("el-form-item",{attrs:{"label-width":"40px",label:"ID",prop:"list."+i+".uid",rules:t.ruleID}},[a("el-input",{staticClass:"width100",model:{value:e.uid,callback:function(a){t.$set(e,"uid",a)},expression:"item.uid"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"职务说明",prop:"list."+i+".title",rules:{required:!0,message:"职务说明不能为空",trigger:"blur"}}},[a("el-input",{attrs:{maxLength:"10"},model:{value:e.title,callback:function(a){t.$set(e,"title",a)},expression:"item.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开通级别",prop:"list."+i+".rule_type",rules:{required:!0,message:"请选择开通级别",trigger:"blur"}}},[a("el-select",{staticClass:"width100",attrs:{placeholder:"请选择"},model:{value:e.rule_type,callback:function(a){t.$set(e,"rule_type",a)},expression:"item.rule_type"}},t._l(t.ruleType,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"用户类型",prop:"list."+i+".user_type",rules:{required:!0,message:"请选择用户类型",trigger:"blur"}}},[a("el-select",{staticClass:"width100",attrs:{placeholder:"请选择"},model:{value:e.user_type,callback:function(a){t.$set(e,"user_type",a)},expression:"item.user_type"}},t._l(t.userType,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"text"},on:{click:function(a){a.preventDefault(),t.removeRow(e)}}},[t._v("删除")])],1)],1)})),t._v(" "),a("div",{staticClass:"align-center"},[a("el-button",{attrs:{type:"text"},on:{click:function(e){return e.preventDefault(),t.addRow(e)}}},[t._v("添加")]),t._v(" "),a("div",{staticClass:"opt"},[a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){e.preventDefault(),t.submitForm()}}},[t._v("提交")]),t._v(" "),a("el-button",{on:{click:function(e){e.preventDefault(),t.dialogVisible=!1}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var p={components:{WhiteAppDialog:a("VU/8")(d,c,!1,function(t){a("WboS")},"data-v-61be176f",null).exports},watch:{},data:function(){return{whiteAuthStatus:u.a.whiteAuthStatus,status:0,listData:[],loading:!1,page:1,pageSize:10,total:0,dialogVisible:!1,detailTable:[]}},computed:l()({},Object(r.b)(["getUserInfo","getAdminLevel"])),created:function(){this.getList()},mounted:function(){},methods:{getList:function(){var t=this;console.log(this.getAdminLevel),this.loading=!0,this.$axios.get(s.a.whiteApplyListApi,{params:{page:this.page-1,page_size:this.pageSize,status:this.status,proposer:4===this.getAdminLevel?null:this.getUserInfo.name}}).then(function(e){t.loading=!1,t.listData=(e.data.result||{}).list||[],t.total=Number((e.data.result||{}).total||0)})},doOperate:function(t,e){var a=this;4!==e.operate_status&&1!==e.operate_status?this.$confirm("是否确认"+e.label+"申请，"+e.label+"后"+(2===e.operate_status?"立即生效，不可撤回":"可以撤回"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.operateAuth({apply_seq:t.apply_seq,status:e.operate_status,auditor:a.getUserInfo.name})}).catch(function(t){console.log(t)}):this.operateAuth({apply_seq:t.apply_seq,status:e.operate_status,auditor:this.getUserInfo.name})},operateAuth:function(t){var e=this;this.loading=!0,this.$axios.post(s.a.whiteAuditApi,t).then(function(t){if(e.loading=!1,t.data.errorNo&&t.data.errorMsg){var a=t.data.errorMsg.replace(/,/g,"<br/>");e.$message.warning({dangerouslyUseHTMLString:!0,message:"<pre>"+a+"</pre>"})}else e.$message.success("操作成功！");e.getList()})},doDetail:function(t){var e=this;this.detailTable=[],this.dialogVisible=!0,this.$axios.get(s.a.whiteDetailApi,{params:{apply_seq:t.apply_seq}}).then(function(t){e.detailTable=t.data.result})},getListbyPage:function(t){this.page=t,this.getList()},addNewWhiteApp:function(){this.$refs.whiteAppDialog.reInit()},addWhiteCallback:function(){this.page=1,this.getList()},changeSatatus:function(){this.page=1,this.getList()}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"mt20"},[a("span",{staticClass:"pad-r"},[t._v("我的申请")]),t._v(" "),a("el-radio-group",{on:{change:t.changeSatatus},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.whiteAuthStatus,function(e){return a("el-radio-button",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),t._v(" "),a("el-button",{staticClass:"fr",attrs:{type:"primary"},on:{click:t.addNewWhiteApp}},[t._v("提交新申请")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"mt10",attrs:{border:"",data:t.listData}},[a("el-table-column",{attrs:{prop:"title",label:"申请人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"申请时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"auditor",label:"审核人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"audit_at",label:"审核时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"审核结果"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.operateList||[],function(i){return a("el-button",{key:i.operate_status,attrs:{type:"text",size:"small"},on:{click:function(a){t.doOperate(e.row,i)}}},[t._v(t._s(i.label))])}),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.doDetail(e.row)}}},[t._v("查看详情")])]}}])})],1),t._v(" "),t.listData.length>0?a("div",{staticClass:"pag-block"},[a("div",{staticClass:"fl"},[t._v("每页"+t._s(t.pageSize)+"条，共 "+t._s(t.total)+" 条记录 第 "+t._s(t.page)+"/"+t._s(t.total)+" 页")]),t._v(" "),a("el-pagination",{staticClass:"fr",attrs:{"current-page":t.page,background:"",layout:"prev, pager, next, jumper","page-size":t.pageSize,total:t.total},on:{"current-change":t.getListbyPage}})],1):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"申请详情",visible:t.dialogVisible,width:"800px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-table",{attrs:{border:"",data:t.detailTable}},[a("el-table-column",{attrs:{prop:"name",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"uid",label:"ID"}}),t._v(" "),a("el-table-column",{attrs:{prop:"title",label:"职务说明"}}),t._v(" "),a("el-table-column",{attrs:{prop:"rule_type",label:"开通级别"}}),t._v(" "),a("el-table-column",{attrs:{prop:"user_type",label:"用户类型"}})],1)],1),t._v(" "),a("white-app-dialog",{ref:"whiteAppDialog",on:{"add-white-callback":t.addWhiteCallback}})],1)},staticRenderFns:[]};var g=a("VU/8")(p,m,!1,function(t){a("O64g")},"data-v-253f321e",null);e.default=g.exports}});
//# sourceMappingURL=4.8bb27b71b7db9041f2ad.js.map